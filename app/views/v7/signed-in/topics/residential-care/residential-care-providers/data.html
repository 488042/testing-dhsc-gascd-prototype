{% extends "v7/layouts/signed-in-map.html" %}

{% set pageName = "Care providers: locations and services" %}

{% block beforeContent %}
{{ govukBreadcrumbs({
  items: [
    {
      text: "Home",
      href: "../../../home"
    },
    {
      text: "Care provision",
      href: "../subtopics"
    }
  ]
}) }}
{% endblock %}

{% block content %}
<div class="govuk-grid-row">

  <div class="govuk-grid-column-two-thirds">
    {% if sessionTimeoutJs == "true" %}
    <meta name="hmrc-timeout-dialog" content="hmrc-timeout-dialog" data-language="en" data-timeout="70" data-countdown="68" data-keep-alive-url="?continue=true" data-sign-out-url="/v7/system/signed-out" data-timeout-url="/v7/system/session-expired" data-title="You will be signed out soon" data-message="For your security, you will be signed out in " data-message-suffix="" data-keep-alive-button-text="" data-sign-out-button-text="" data-synchronise-tabs="" data-hide-sign-out-button="" />
    {% elif sessionTimeoutNonJs == "true" %}

    <div class="govuk-notification-banner" role="region" aria-labelledby="govuk-notification-banner-title" data-module="govuk-notification-banner">

      <div class="govuk-notification-banner__header">
        <h2 class="govuk-notification-banner__title" id="govuk-notification-banner-title">Important</h2>
      </div>

      <div class="govuk-notification-banner__content">
        <p class="govuk-body">For your security, we will sign you out if you are inactive for <strong>20 minutes</strong>.</p>
      </div>

    </div>

    {% endif %}
    <h1 class="govuk-heading-xl">{{pageName}}</h1>
    <p class="govuk-body-l">Data on care provision by location, service type and number of providers.</p>
    <h2 class="govuk-heading-l govuk-!-margin-top-9">Data overview</h2>
    <!-- <p class="govuk-body">Data overview summary information, e.g. broad guidance.</p> -->
  </div>

</div>

<div class="govuk-grid-row">

  <div class="govuk-grid-column-full">

    <div class="data-box govuk-form-group">

      <div class="govuk-tabs" data-module="govuk-tabs">
        
        <div class="govuk-form-group">
          <h3 id="data1" class="govuk-heading-m">Care provider locations near {% if data.postcode1 %}postcode {{data.postcode1}}{% else %}postcode CO5 1ST for {{data.locationName or 'Shoggins Care Services (Sudbury)'}}{% endif %}</h3>
          <p class="govuk-body">Locations and service information for CQC&#45;registered residential social care and community based adult social care service providers in England, August 2025.</p>
          <!-- THIS INDICATOR DEFINITION PAGE DOES NOT EXIST
          <p class="govuk-body" data-module="edge">Find out <a href="#" data-message="Sorry, this hasn’t been designed yet">how locations and services data is collected</a>.</p> -->
          {% include "./filters/_1-filter-component.html" %}
        </div>        

        <h3 class="govuk-tabs__title">Contents</h3>
        <ul class="govuk-tabs__list">
          <li class="govuk-tabs__list-item govuk-tabs__list-item--selected">
            <a class="govuk-tabs__tab" href="#data1-map">Map</a>
          </li>
          <li class="govuk-tabs__list-item">
            <a class="govuk-tabs__tab" href="#data1-table">Table</a>
          </li>
          <li class="govuk-tabs__list-item">
            <a class="govuk-tabs__tab" href="#data1-download">Download</a>
          </li>
        </ul>

        <div class="govuk-tabs__panel" id="data1-map">
          {% include "./data-visualisations/_1-map.html" %}
        </div>

        <div class="govuk-tabs__panel" id="data1-table">
          {% include "./data-visualisations/_1-table.html" %}
        </div>

        <div class="govuk-tabs__panel" id="data1-download">
          <h4 class="govuk-heading-s">Download</h4>
          <ul class="govuk-list" data-module="edge">
            <li>
              <a class="govuk-link" href="#" data-message="Sorry, this hasn’t been designed yet">Download current map image (PNG, 2 MB)</a>
            </li>
            <li>
              <a class="govuk-link" href="#" data-message="Sorry, this hasn’t been designed yet">Export table data (CSV, 420 KB)</a>
            </li>
          </ul>
        </div>

      </div>

    </div>

  </div>

</div>

<div class="govuk-grid-row">

  <div class="govuk-grid-column-full">

    <div class="data-box govuk-form-group">

      <div class="govuk-tabs" data-module="govuk-tabs">

        <div class="govuk-form-group">
          <h3 class="govuk-heading-m">Number of adult social care providers</span></h3>
          <!-- Commented out until Edge Health provide the content for this new page -->
          <!-- <p class="govuk-body">Find out <span class="needs-content"><a href="../../../help/total-number-community-social-care-providers">how the number of adult social care providers is calculated</a></span>.</p> -->
          <p class="govuk-body" data-module="edge">Find out <span class="needs-content"><a href="#" data-message="Sorry, this hasn’t been designed yet">how the number of adult social care providers is calculated</a></span>.</p>
        </div>

        <h3 class="govuk-tabs__title">Contents</h3>
        <ul class="govuk-tabs__list">
          <li class="govuk-tabs__list-item">
            <a class="govuk-tabs__tab" href="#data2-table">Table</a>
          </li>
          <li class="govuk-tabs__list-item">
            <a class="govuk-tabs__tab" href="#data2-download">Download</a>
          </li>
        </ul>

        <div class="govuk-tabs__panel" id="data2-table">
          {% include "./data-visualisations/_2-table.html" %}
        </div>

        <div class="govuk-tabs__panel" id="data2-download">
          <h4 class="govuk-heading-s">Download</h4>
          <ul class="govuk-list" data-module="edge">
            <li>
              <a class="govuk-link" href="#" data-message="Sorry, this hasn’t been designed yet">Export table data (CSV, 420 KB)</a>
            </li>
          </ul>
        </div>

      </div>

    </div>

  </div>

</div>

<div class="govuk-grid-row">

  <div class="govuk-grid-column-two-thirds">
    <h2 class="govuk-heading-l govuk-!-margin-top-9">Data indicator details</h2>
    <p class="govuk-body">Use the link to view details on the data source, how the data was collected and any limitations to consider when using the data.</p>

    <div class="gem-c-cards">
      <ul class="gem-c-cards__list gem-c-cards__list--one-column">
        <li class="gem-c-cards__list-item">

          <div class="gem-c-cards__list-item-wrapper">
            <h2 class="gem-c-cards__sub-heading govuk-heading-s" data-module="edge">
              <!-- Commented out until Edge Health provide the content for this new page -->
              <!-- <a class="govuk-link gem-c-cards__link gem-c-force-print-link-styles" href="../../../help/total-number-community-social-care-providers">Number of community social care providers</a> -->
              <a class="govuk-link gem-c-cards__link gem-c-force-print-link-styles" href="#" data-message="Sorry, this hasn’t been designed yet">Number of community social care providers</a>
            </h2>
            <p class="govuk-body gem-c-cards__description">Source: Care Quality Commission. <br>Monthly updates, limitations apply.</p>
          </div>

        </li>
      </ul>
    </div>

    <h2 class="govuk-heading-l govuk-!-margin-top-9">Related data</h2>

    <div class="gem-c-cards">
      <ul class="gem-c-cards__list gem-c-cards__list--one-column">
        <li class="gem-c-cards__list-item">

          <div class="gem-c-cards__list-item-wrapper">
            <h2 class="gem-c-cards__sub-heading govuk-heading-s">
              <a class="govuk-link gem-c-cards__link gem-c-force-print-link-styles" href="../provision-and-occupancy/data">Care home beds and occupancy levels</a>
            </h2>
            <p class="govuk-body gem-c-cards__description">Provision and capacity data for care homes, including local, regional and national statistics.</p>
          </div>

        </li>
        <li class="gem-c-cards__list-item">

          <div class="gem-c-cards__list-item-wrapper">
            <h2 class="gem-c-cards__sub-heading govuk-heading-s">
              <a class="govuk-link gem-c-cards__link gem-c-force-print-link-styles" href="../unpaid-care/data">Unpaid care</a>
            </h2>
            <p class="govuk-body gem-c-cards__description">Statistics on the people who provide unpaid care to family members, friends and neighbours.</p>
          </div>

        </li>
      </ul>
    </div>

    <h2 class="govuk-heading-l govuk-!-margin-top-9">Information on the local care market</h2>
    <p class="govuk-body" data-module="edge"><a href="#" class="govuk-link" data-message="This link would take you to the Market Position Statement on the Suffolk local authority website.">Market Position Statement for Suffolk (opens in new tab)</a></p>
    <p class="govuk-body">Most local authorities in England publish Market Position Statements (MPS) to help care providers understand the local care market.</p>
    <p class="govuk-body">You can usually find these <abbr title="Market Position Statement">MPS</abbr> documents on local authority websites.</p>
    <p class="govuk-body"><abbr title="Market Position Statement">MPS</abbr> documents include information on:</p>
    <ul class="govuk-list govuk-list--bullet">
      <li>supply and demand in the local care market</li>
      <li>forecasts of future supply and demand for adult social care services</li>
      <li>how the local authority will support the local care market to meet demand</li>
      <li>how the local authority will engage with care providers on challenges in the sector, such as funding pressures</li>
    </ul>

    <div data-sticky-element class="gem-c-contents-list-with-body__link-wrapper govuk-!-margin-top-9">

      <div class="gem-c-contents-list-with-body__link-container">
        <a class="govuk-link gem-c-back-to-top-link govuk-!-display-none-print" href="#top">
          <svg class="gem-c-back-to-top-link__icon" xmlns="http://www.w3.org/2000/svg" width="13" height="17" viewBox="0 0 13 17" aria-hidden="true" focusable="false">
            <path fill="currentColor" d="M6.5 0L0 6.5 1.4 8l4-4v12.7h2V4l4.3 4L13 6.4z"></path>
          </svg>
          Back to top
        </a>
      </div>

    </div>

  </div>

</div>
{% endblock %}

{% block pageScripts %}
<!-- jQuery (progressive enhancement) that loads and controls the dynamic filters for this page -->
<script type="text/javascript">
  
  window.addEventListener('load', function() {

    // Hide all dynamic filter sections (i.e. all filter options)
    $('.defra-filter--content').hide();
    // Show all dynamic filter buttons
    $('.defra-filter--action').show();

    // User interacts with the filter button
    $('#defra-filter--button').on("click", function() {
      
      if (!$('#defra-filter--action').hasClass('defra-filter--open')) {
        $('#defra-filter--content').show().focus();
        $('#defra-filter--action').addClass('defra-filter--open');
        $('#defra-filter--button').attr('aria-expanded', 'true');
        $("#defra-filter--button .defra-filter--button-content").text('Hide filters');
      }
      else {
        $('#defra-filter--content').hide();
        $('#defra-filter--action').removeClass('defra-filter--open');
        $('#defra-filter--button').attr('aria-expanded', 'false');
        $("#defra-filter--button .defra-filter--button-content").text('Show filters');
      }

    });

    /* Quick and dirty way of updating the filters individually, when a user clicks a related pill */
    // Postcode
    $('#postcode-remove').on("click", function(e) {
      e.preventDefault();
      $('#postcode').val('');
      $('#update-filters').click();
    });
    // Homecare agencies
    $('#serviceType1_1-remove').on("click", function(e) {
      e.preventDefault();
      $('#serviceType1_1').prop("checked", false);
      $('#update-filters').click();
    });
    // Nursing homes
    $('#serviceType1_2-remove').on("click", function(e) {
      e.preventDefault();
      $('#serviceType1_2').prop("checked", false);
      $('#update-filters').click();
    });
    // Residential homes
    $('#serviceType1_3-remove').on("click", function(e) {
      e.preventDefault();
      $('#serviceType1_3').prop("checked", false);
      $('#update-filters').click();
    });
    // Supported housing
    $('#serviceType1_4-remove').on("click", function(e) {
      e.preventDefault();
      $('#serviceType1_4').prop("checked", false);
      $('#update-filters').click();
    });
    // Supported living
    $('#serviceType1_5-remove').on("click", function(e) {
      e.preventDefault();
      $('#serviceType1_5').prop("checked", false);
      $('#update-filters').click();
    });

  });
  
</script>
{% endblock %}